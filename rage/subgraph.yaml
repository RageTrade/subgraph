specVersion: 0.0.2
description: Rage Perpswap Contracts
repository: https://github.com/rage-trade/perpswap-contracts
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: ClearingHouse
    network: arbitrum-goerli
    source:
      address: '0x7047343e3eF25505263116212EE74430A2A12257'
      abi: ClearingHouse
      startBlock: 587666
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Account
        - Collateral
        - TokenPosition
        - LiquidateToken
        - LiquidateRangePosition
        - LiquidityPosition
        - LiquidityPositionEntry
        - Protocol
      abis:
        - name: ClearingHouse
          file: ./abis/ClearingHouse.json
        - name: VPoolWrapperLogic
          file: ./abis/VPoolWrapperLogic.json
        - name: UniswapV3Pool
          file: ./abis/UniswapV3Pool.json
      file: ./src/mappings/clearinghouse/handlers.ts
      eventHandlers:
        - event: AccountCreated(indexed address,uint256)
          handler: handleAccountCreated
        - event: TokenPositionFundingPaymentRealized(indexed uint256,indexed
            uint32,int256,int256)
          handler: handleTokenPositionFundingPaymentRealized
        - event: TokenPositionChanged(indexed uint256,indexed
            uint32,int256,int256,uint160,uint160)
          handler: handleTokenPositionChanged
        - event: MarginUpdated(indexed uint256,indexed uint32,int256,bool)
          handler: handleMarginUpdated
        - event: PoolSettingsUpdated(uint32,(uint16,uint16,uint16,uint32,bool,bool,address))
          handler: handlePoolSettingsUpdated
        - event: TokenPositionLiquidated(indexed uint256,indexed
            uint32,int256,int256,int256)
          handler: handleTokenPositionLiquidated
        - event: ProfitUpdated(indexed uint256,int256)
          handler: handleProfitUpdated
        - event: LiquidityPositionEarningsRealized(indexed uint256,indexed
            uint32,int24,int24,int256)
          handler: handleLiquidityPositionEarningsRealized
  - kind: ethereum/contract
    name: CurveYieldStrategy
    network: arbitrum-goerli
    source:
      address: '0xddDcfF2D6CB373C2F1A115bAC6B1862b72b812f4'
      abi: CurveYieldStrategy
      startBlock: 587666
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: CurveQuoter
          file: ./abis/CurveQuoter.json
        - name: CurveYieldStrategy
          file: ./abis/CurveYieldStrategy.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/CurveYieldStrategy/handler.ts
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleWithdraw
        - event: Rebalance()
          handler: handleRebalance
  - kind: ethereum/contract
    name: VaultPeriphery
    network: arbitrum-goerli
    source:
      address: '0x5d44c28E34343888923aCFAc34AF617461657f9B'
      abi: VaultPeriphery
      startBlock: 587666
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: VaultPeriphery
          file: ./abis/VaultPeriphery.json
        - name: CurveYieldStrategy
          file: ./abis/CurveYieldStrategy.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/VaultPeriphery/handler.ts
      eventHandlers:
        - event: DepositPeriphery(indexed address,indexed address,uint256,uint256,uint256)
          handler: handleDepositPeriphery
  - kind: ethereum/contract
    name: GMXYieldStrategy
    network: arbitrum-goerli
    source:
      address: '0x4AB3e468C0afee9e0941D9FB26CDFDb438cff8dF'
      abi: GMXYieldStrategy
      startBlock: 587666
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: GMXYieldStrategy
          file: ./abis/GMXYieldStrategy.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
        - name: CurveYieldStrategy
          file: ./abis/CurveYieldStrategy.json
      file: ./src/mappings/gmx/gys-handler.ts
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleWithdraw
        - event: TokenWithdrawn(indexed address,indexed address,indexed
            address,address,uint256,uint256)
          handler: handleTokenWithdrawn
        - event: Rebalance()
          handler: handleRebalance
  - kind: ethereum/contract
    name: DnGmxSeniorVault
    network: arbitrum-goerli
    source:
      address: '0xef50d59f1F39f059d379Ce3F3BA88Ef8e23EEdf9'
      abi: DnGmxSeniorVault
      startBlock: 587666
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: DnGmxSeniorVault
          file: ./abis/DnGmxSeniorVault.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/DnGMX/DnGmxSeniorVault.ts
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleWithdraw
  - kind: ethereum/contract
    name: DnGmxJuniorVault
    network: arbitrum-goerli
    source:
      address: '0x06c89eF14ED8D69044b3B04619a683828754F0d8'
      abi: DnGmxJuniorVault
      startBlock: 587666
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: DnGmxJuniorVault
          file: ./abis/DnGmxJuniorVault.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/DnGMX/DnGmxJuniorVault.ts
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleWithdraw
        - event: Rebalanced()
          handler: handleRebalance
  - kind: ethereum/contract
    name: DnGmxBatchingManager
    network: arbitrum-goerli
    source:
      address: '0xdbEfc2E5eF462b4a9aa0dab7e24C46C8328CCE84'
      abi: DnGmxBatchingManager
      startBlock: 587666
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: DnGmxJuniorVault
          file: ./abis/DnGmxJuniorVault.json
        - name: DnGmxBatchingManager
          file: ./abis/DnGmxBatchingManager.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/DnGMX/DnGmxBatchingManager.ts
      eventHandlers:
        - event: DepositToken(indexed uint256,indexed address,indexed
            address,uint256,uint256)
          handler: handleDepositToken
        - event: BatchDeposit(indexed uint256,uint256,uint256,uint256)
          handler: handleBatchDeposit
  - kind: ethereum/contract
    name: GMXBatchingManager
    network: arbitrum-goerli
    source:
      address: '0x3d38Ff7Cbf232b314623510f0Ccda847414148c9'
      abi: GMXBatchingManager
      startBlock: 587666
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: GMXYieldStrategy
          file: ./abis/GMXYieldStrategy.json
        - name: GMXBatchingManager
          file: ./abis/GMXBatchingManager.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
        - name: CurveYieldStrategy
          file: ./abis/CurveYieldStrategy.json
      file: ./src/mappings/gmx/gbm-handler.ts
      eventHandlers:
        - event: DepositToken(indexed uint256,indexed address,indexed
            address,uint256,uint256)
          handler: handleGmxDepositToken
        - event: BatchDeposit(indexed uint256,uint256,uint256)
          handler: handleGmxBatch
  - kind: ethereum/contract
    name: RageTradeFactory
    network: arbitrum-goerli
    source:
      address: '0x400E797E9ad4A8E5759Fbb5F39F5f34e074133D2'
      abi: RageTradeFactory
      startBlock: 587666
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - RageTradePool
      abis:
        - name: ClearingHouse
          file: ./abis/ClearingHouse.json
        - name: ClearingHouseLens
          file: ./abis/ClearingHouseLens.json
        - name: RageTradeFactory
          file: ./abis/RageTradeFactory.json
        - name: VPoolWrapperLogic
          file: ./abis/VPoolWrapperLogic.json
        - name: UniswapV3Pool
          file: ./abis/UniswapV3Pool.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/ragetradeFactory/handler.ts
      eventHandlers:
        - event: PoolInitialized(address,address,address)
          handler: handlePoolInitialized
  - kind: ethereum/contract
    name: UniswapV3Factory
    network: arbitrum-goerli
    source:
      address: '0x4584E64B9cae7c86810a8a0A3c4469c4d164459f'
      abi: UniswapV3Factory
      startBlock: 587666
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/uniswap/factory.ts
      entities:
        - UniswapV3Pool
        - UniswapV3Token
      abis:
        - name: UniswapV3Factory
          file: ./abis/UniswapV3Factory.json
        - name: UniswapV3Pool
          file: ./abis/UniswapV3Pool.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      eventHandlers:
        - event: PoolCreated(indexed address,indexed address,indexed uint24,int24,address)
          handler: handlePoolCreated
templates:
  - kind: ethereum/contract
    name: UniswapV3Pool
    network: arbitrum-goerli
    source:
      abi: UniswapV3Pool
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/uniswap/core.ts
      entities:
        - UniswapV3Pool
        - UniswapV3Token
      abis:
        - name: UniswapV3Pool
          file: ./abis/UniswapV3Pool.json
        - name: UniswapV3Factory
          file: ./abis/UniswapV3Factory.json
      eventHandlers:
        - event: Initialize(uint160,int24)
          handler: handleInitialize
        - event: Mint(address,indexed address,indexed int24,indexed
            int24,uint128,uint256,uint256)
          handler: handleMint
        - event: Burn(indexed address,indexed int24,indexed int24,uint128,uint256,uint256)
          handler: handleBurn
  - kind: ethereum/contract
    name: VPoolWrapperLogic
    network: arbitrum-goerli
    source:
      abi: VPoolWrapperLogic
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/vPoolWrapper/handler.ts
      entities:
        - VPoolWrapper
      abis:
        - name: ClearingHouse
          file: ./abis/ClearingHouse.json
        - name: VPoolWrapperLogic
          file: ./abis/VPoolWrapperLogic.json
        - name: UniswapV3Pool
          file: ./abis/UniswapV3Pool.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      eventHandlers:
        - event: Swap((int256,int256,int256,uint256,uint256,uint160,uint160))
          handler: handleSwap
        - event: Mint(int24,int24,uint128,uint256,uint256)
          handler: handleMint
        - event: Burn(int24,int24,uint128,uint256,uint256)
          handler: handleBurn
