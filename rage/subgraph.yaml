specVersion: 0.0.2
description: Rage Perpswap Contracts
repository: https://github.com/rage-trade/perpswap-contracts
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: ClearingHouse
    network: arbitrum-rinkeby
    source:
      address: '0xD0d0DCD012E4a177e840e6703ab308cBA7D78DbD'
      abi: ClearingHouse
      startBlock: 14139220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Account
        - Collateral
        - TokenPosition
        - LiquidateToken
        - LiquidateRangePosition
        - LiquidityPosition
        - LiquidityPositionEntry
        - Protocol
      abis:
        - name: ClearingHouse
          file: ./abis/ClearingHouse.json
        - name: VPoolWrapperLogic
          file: ./abis/VPoolWrapperLogic.json
        - name: UniswapV3Pool
          file: ./abis/UniswapV3Pool.json
      file: ./src/mappings/clearinghouse/handlers.ts
      eventHandlers:
        - event: AccountCreated(indexed address,uint256)
          handler: handleAccountCreated
        - event: TokenPositionFundingPaymentRealized(indexed uint256,indexed
            uint32,int256,int256)
          handler: handleTokenPositionFundingPaymentRealized
        - event: TokenPositionChanged(indexed uint256,indexed
            uint32,int256,int256,uint160,uint160)
          handler: handleTokenPositionChanged
        - event: MarginUpdated(indexed uint256,indexed uint32,int256,bool)
          handler: handleMarginUpdated
        - event: PoolSettingsUpdated(uint32,(uint16,uint16,uint16,uint32,bool,bool,address))
          handler: handlePoolSettingsUpdated
        - event: TokenPositionLiquidated(indexed uint256,indexed
            uint32,int256,int256,int256)
          handler: handleTokenPositionLiquidated
        - event: ProfitUpdated(indexed uint256,int256)
          handler: handleProfitUpdated
  - kind: ethereum/contract
    name: CurveYieldStrategy
    network: arbitrum-rinkeby
    source:
      address: '0x505a15841Ad96F8E893eFD66760b02eC86a43C0F'
      abi: CurveYieldStrategy
      startBlock: 14139220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: CurveQuoter
          file: ./abis/CurveQuoter.json
        - name: CurveYieldStrategy
          file: ./abis/CurveYieldStrategy.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/CurveYieldStrategy/handler.ts
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleWithdraw
  - kind: ethereum/contract
    name: VaultPeriphery
    network: arbitrum-rinkeby
    source:
      address: '0xA4925AC74C229674979E4BCB467E5a99453960B6'
      abi: VaultPeriphery
      startBlock: 14139220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: VaultPeriphery
          file: ./abis/VaultPeriphery.json
        - name: CurveYieldStrategy
          file: ./abis/CurveYieldStrategy.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/VaultPeriphery/handler.ts
      eventHandlers:
        - event: DepositPeriphery(indexed address,indexed address,uint256,uint256,uint256)
          handler: handleDepositPeriphery
  - kind: ethereum/contract
    name: GMXYieldStrategy
    network: arbitrum-rinkeby
    source:
      address: '0x499F97A1F2eDFbDde4E164Bb05f9cf8499E90ab2'
      abi: GMXYieldStrategy
      startBlock: 14139220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: GMXYieldStrategy
          file: ./abis/GMXYieldStrategy.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/gmx/gys-handler.ts
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDepositPeriphery
        - event: Withdraw(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleDepositPeriphery
  - kind: ethereum/contract
    name: GMXBatchingManager
    network: arbitrum-rinkeby
    source:
      address: '0xb0212a93d2d6b863c8De47a33bC8e259E6439d9d'
      abi: GMXBatchingManager
      startBlock: 14139220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VaultDepositWithdrawEntry
        - Vault
        - Owner
        - ERC20Token
      abis:
        - name: GMXBatchingManager
          file: ./abis/GMXBatchingManager.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/gmx/gbm-handler.ts
      eventHandlers:
        - event: DepositToken(indexed uint256,indexed address,indexed address,uint256,uint256)
          handler: handleDepositToken
  - kind: ethereum/contract
    name: RageTradeFactory
    network: arbitrum-rinkeby
    source:
      address: '0xa97ADDd8D76a9253a4fD3244d6CF281D7Bede22c'
      abi: RageTradeFactory
      startBlock: 14139220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - RageTradePool
      abis:
        - name: ClearingHouse
          file: ./abis/ClearingHouse.json
        - name: ClearingHouseLens
          file: ./abis/ClearingHouseLens.json
        - name: RageTradeFactory
          file: ./abis/RageTradeFactory.json
        - name: VPoolWrapperLogic
          file: ./abis/VPoolWrapperLogic.json
        - name: UniswapV3Pool
          file: ./abis/UniswapV3Pool.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      file: ./src/mappings/ragetradeFactory/handler.ts
      eventHandlers:
        - event: PoolInitialized(address,address,address)
          handler: handlePoolInitialized
  - kind: ethereum/contract
    name: UniswapV3Factory
    network: arbitrum-rinkeby
    source:
      address: '0x1F98431c8aD98523631AE4a59f267346ea31F984'
      abi: UniswapV3Factory
      startBlock: 14139220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/uniswap/factory.ts
      entities:
        - UniswapV3Pool
        - UniswapV3Token
      abis:
        - name: UniswapV3Factory
          file: ./abis/UniswapV3Factory.json
        - name: UniswapV3Pool
          file: ./abis/UniswapV3Pool.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      eventHandlers:
        - event: PoolCreated(indexed address,indexed address,indexed uint24,int24,address)
          handler: handlePoolCreated
templates:
  - kind: ethereum/contract
    name: UniswapV3Pool
    network: arbitrum-rinkeby
    source:
      abi: UniswapV3Pool
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/uniswap/core.ts
      entities:
        - UniswapV3Pool
        - UniswapV3Token
      abis:
        - name: UniswapV3Pool
          file: ./abis/UniswapV3Pool.json
        - name: UniswapV3Factory
          file: ./abis/UniswapV3Factory.json
      eventHandlers:
        - event: Initialize(uint160,int24)
          handler: handleInitialize
        - event: Mint(address,indexed address,indexed int24,indexed
            int24,uint128,uint256,uint256)
          handler: handleMint
        - event: Burn(indexed address,indexed int24,indexed int24,uint128,uint256,uint256)
          handler: handleBurn
  - kind: ethereum/contract
    name: VPoolWrapperLogic
    network: arbitrum-rinkeby
    source:
      abi: VPoolWrapperLogic
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/vPoolWrapper/handler.ts
      entities:
        - VPoolWrapper
      abis:
        - name: ClearingHouse
          file: ./abis/ClearingHouse.json
        - name: VPoolWrapperLogic
          file: ./abis/VPoolWrapperLogic.json
        - name: UniswapV3Pool
          file: ./abis/UniswapV3Pool.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      eventHandlers:
        - event: Swap((int256,int256,int256,uint256,uint256,uint160,uint160))
          handler: handleSwap
        - event: Mint(int24,int24,uint128,uint256,uint256)
          handler: handleMint
        - event: Burn(int24,int24,uint128,uint256,uint256)
          handler: handleBurn
